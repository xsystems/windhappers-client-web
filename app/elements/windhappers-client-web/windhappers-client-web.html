<link rel="import" href="pages/windhappers-page-mock.html">
<link rel="import" href="pages/windhappers-page-contact.html">
<link rel="import" href="pages/windhappers-page-costs.html">
<link rel="import" href="pages/windhappers-page-location.html">
<link rel="import" href="pages/windhappers-page-calendar.html">
<link rel="import" href="pages/windhappers-page-videos.html">

<dom-module id="windhappers-client-web">
  <template>
    
    <style>
      /* Breakpoints */

      /* Small */
      @media (max-width: 640px) {
        [title] {
          font-size: 30px;
        }

        [condensed-title] {
          font-size: 15px;
        }
      }

      /* Tablet+ */
      @media (min-width: 641px) {

      }

      app-header {
        position: fixed;
        top: 0;
        left: 0;
        color: #fff;
        --app-header-background-rear-layer: {
          background-color: var(--primary-color);
        };
        --app-header-background-front-layer: {
          background-image: url(../../images/header/header_default.jpg);
          background-position: left 66%;
        };
      }

      app-toolbar[sticky] {
        height: var(--toolbar-height-primary);
      }
              
      app-toolbar:not([sticky]) {
        height: var(--toolbar-height-secondary);
      }

      [main-title] {
        font-weight: lighter;
        margin: 0;
        position: absolute;
        left: 80px;
        bottom: 30%;
      }  

      [condensed-title] {
        font-weight: lighter;
        margin-left: 30px;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      [condensed-title] i {
        font-weight: 100;
        font-style: normal;
      }

      paper-menu {
        --paper-menu-selected-item: {
          color: var(--primary-color);
        }
      }

      paper-menu, paper-submenu paper-item { 
        text-rendering: optimizeLegibility;
      }

      paper-submenu paper-menu {
        padding-left: 10%;
      }

      #menu {
        height: 100%;
        overflow: auto;
      }

      neon-animated-pages {
        height: var(--page-height);
      }

      neon-animatable {
        @apply(--layout-vertical);
      }

      #facebook {
        --iron-icon-width: 16px;
        --iron-icon-height: 16px;
      }
    </style>

    <app-location route="{{route}}"></app-location>

    <app-route route="{{route}}"
                  pattern="/:page"
                  data="{{pageData}}"
                  tail="{{pageTail}}"></app-route>

    <app-drawer-layout  narrow="{{narrow}}"
                        responsive-width="768px">
      <app-drawer id="drawer" swipe-open>
        <div id="menu">
          <paper-menu selectable="paper-item" 
                      selected='{{pageData.page}}' 
                      attr-for-selected="data-page">
            <paper-item data-page="home">Home</paper-item>
            <paper-item data-page="calendar">Kalender</paper-item>
            <paper-item data-page="disciplines">Disciplines</paper-item>
            <paper-submenu>
              <paper-item class="menu-trigger">Media</paper-item>
              <paper-menu class="menu-content" selectable="paper-item" selected='{{pageData.page}}' attr-for-selected="data-page">
                <paper-item data-page="photos">Foto's</paper-item>
                <paper-item data-page="videos">Video's</paper-item>
                <paper-item data-page="blogs">Blogs</paper-item>
              </paper-menu>
            </paper-submenu>
            <paper-item data-page="canoeroutes">Kanoroutes</paper-item>
            <paper-submenu id="menuSafety">
              <paper-item class="menu-trigger">Veiligheid</paper-item>
              <paper-menu class="menu-content">
                <paper-item on-tap="_showPageWaterQuality">Waterkwaliteit</paper-item>
                <paper-item on-tap="_showPageKNRM">KNRM App</paper-item>
              </paper-menu>
            </paper-submenu>
            <paper-submenu>
              <paper-item class="menu-trigger">Over ons</paper-item>
              <paper-menu class="menu-content" selectable="paper-item" selected='{{pageData.page}}' attr-for-selected="data-page">
                <paper-item data-page="contact">Contact</paper-item>
                <paper-item data-page="location">Locatie</paper-item>
                <paper-item data-page="costs">Kosten &amp; Inschrijven</paper-item>
                <paper-item data-page="sponsors">Sponsoren</paper-item>
              </paper-menu>
            </paper-submenu>
          </paper-menu>
        </div>
      </app-drawer>
      <app-header-layout>
        <app-header fixed condenses effects="material">
          <app-toolbar sticky>
            <paper-icon-button icon="menu" drawer-toggle></paper-icon-button>
            <h4 condensed-title>De Windhappers</h4>
            <a href="https://twitter.com/DeWindhappers" target="_blank">
              <iron-icon src="../../../images/social/twitter.png"></iron-icon>
            </a>
            <a href="http://www.facebook.com/pages/Kanovereniging-De-Windhappers/546877148674699" target="_blank">
              <iron-icon id="facebook" src="../../../images/social/facebook.png"></iron-icon>
            </a>
          </app-toolbar>
          <app-toolbar class="secondary">
            <h1 main-title>De Windhappers</h1>
          </app-toolbar>
        </app-header>

        <neon-animated-pages selected="[[pageData.page]]"
                     attr-for-selected="data-page"
                     entry-animation="slide-from-left-animation"
                     exit-animation="slide-right-animation"
                     on-iron-resize="closeDrawer">
          <neon-animatable data-page="home">
            <windhappers-page-mock></windhappers-page-mock>
          </neon-animatable>
          
          <neon-animatable data-page="calendar">
            <windhappers-page-calendar narrow="[[narrow]]"></windhappers-page-calendar>
          </neon-animatable>
          
          <neon-animatable data-page="disciplines">
            <windhappers-page-mock  narrow
                                    route="{{pageTail}}"></windhappers-page-mock>
          </neon-animatable>

          <neon-animatable data-page="photos">
            <windhappers-page-mock  narrow="[[narrow]]"
                                    route="{{pageTail}}"></windhappers-page-mock>
          </neon-animatable>

          <neon-animatable data-page="videos">
            <windhappers-page-videos  narrow="[[narrow]]"
                                      route="{{pageTail}}"></windhappers-page-videos>
          </neon-animatable>

          <neon-animatable data-page="blogs">
            <windhappers-page-mock  narrow="[[narrow]]"
                                    route="{{pageTail}}"></windhappers-page-mock>
          </neon-animatable>

          <neon-animatable data-page="canoeroutes">
            <windhappers-page-mock  narrow="[[narrow]]"
                                    route="{{pageTail}}"></windhappers-page-mock>
          </neon-animatable>

          <neon-animatable data-page="contact">
            <windhappers-page-contact narrow="[[narrow]]"></windhappers-page-contact>
          </neon-animatable>

          <neon-animatable data-page="location">
            <windhappers-page-location></windhappers-page-location>
          </neon-animatable>
          
          <neon-animatable data-page="costs">
            <windhappers-page-costs narrow="[[narrow]]"></windhappers-page-costs>
          </neon-animatable>

          <neon-animatable data-page="sponsors">
            <windhappers-page-mock narrow="[[narrow]]"></windhappers-page-mock>
          </neon-animatable>
        </neon-animated-pages>
      </app-header-layout>
    </app-drawer-layout>

  </template>

  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'windhappers-client-web',

        behaviors: [
          Polymer.IronResizableBehavior
        ],        

        properties: {
          narrow: Boolean
        },

        observers: [
          '_resetLayout(narrow, isAttached)',
          '_updateMenus(pageData.page)'
        ],

        attached: function() {
          this.async(function() {
            if (!this.route.path || this.route.path == '/') {
              this.set('route.path', 'home');
            }
          });
        },

        _resetLayout: function() {
          this.debounce('_resetLayout', function() {
            if (!this.isAttached) {
              return;
            }

            if (this.narrow) {
              this.customStyle['--toolbar-height-primary'] = '64px';
              this.customStyle['--toolbar-height-secondary'] = '32px';
            } else {
              this.customStyle['--toolbar-height-primary'] = '64px';
              this.customStyle['--toolbar-height-secondary'] = '96px';
            }

            this.customStyle['--page-height'] = 'calc(100vh - var(--toolbar-height-primary) - var(--toolbar-height-secondary))';

            this.updateStyles();
            this.notifyResize();
          });        
        },

        closeDrawer: function() {
          if (this.narrow) {
            this.$.drawer.close();
          }
        },

        _showPageHome: function() {
          this.set("pageData.page", "home");
        },

        _showPageWaterQuality: function() {
          window.open("http://zwemwater.nl/", "_blank");
        },

        _showPageKNRM: function() {
          window.open("https://www.knrm.nl/wat-doet-de-knrm/veiligheid-voor-pleziervaart/knrm-helpt-app/", "_blank");
        }, 

        _updateMenus: function(page) {
          if (this.$.menuSafety.opened) {
            this.$.menuSafety.close();
          }
        }
      })
    })();
  </script>
</dom-module>
