<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/google-sheets/google-sheets.html">
<link rel="import" href="../../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../windhappers-volunteer/windhappers-volunteer.html">
<link rel="import" href="../../windhappers-notification/windhappers-notification.html">
<link rel="import" href="../../../styles/shared-styles.html">

<dom-module id="windhappers-page-costs">
  <template>
    <style include="shared-styles">
      :host {
        @apply(--layout-horizontal);
        @apply(--layout-justified);
        @apply(--layout-wrap);
        padding-top: 1%;
        padding-left: 1%;
        padding-right: 1%;
      }

      @-moz-document url-prefix() {
        :host {
          height: 100%;
        }
      }

      windhappers-volunteer {
        margin-bottom: 1%;
      }

      windhappers-volunteer[narrow] {
        width: 100%;
      }

      windhappers-volunteer:not([narrow]) {
        width: 32.66%;
      }

      windhappers-notification {
        background-color: white;
      }

      paper-card, windhappers-notification {
        width: 100%;
        margin-bottom: 1%;
      }

      table {
        border-collapse: collapse;
        width: 100%;
      }

      th {
        background-color: var(--primary-color);
        color: white;
      }

      th, td {
        text-align: left;
        padding: 1%;
      }

      tr:nth-child(even) {
        background-color: #f2f2f2
      }
    </style>

    <paper-card>
      <div class="card-content">
        <article>
          <header>
            <span class="headline">Inschrijven<span>
            <p>
              Wil je iets aan je conditie doen? Denk dan eens aan de kanosport in plaats van aan de sportschool. Kanovaren is niet aan leeftijd gebonden en je bent lekker in de buitenlucht. Bij de Windhappers hebben we leden van 8 tot 80 jaar en ook ruimte voor nieuwe leden.
            </p>
          </header>
          <p>
            Elke woensdagavond is onze clubavond, kom gerust eens langs voor informatie of maak een afspraak voor een proefvaart met een clubboot. Onze leden helpen u graag op weg. Of kom eens kijken op onze Open Dag.
          </p>
          <p>
            Heb je geen eigen kano? Geen probleem! Wij beschikken over een aantal clubboten, deze boten zijn beschikbaar voor leden die (nog) geen eigen boot bezitten.
          </p>
          <p>
            Elk jaar worden regelmatig basiscursussen voor nieuwe leden georganiseerd. Hierbij worden de grondbeginselen van het kanovaren aangeleerd. Elk nieuw lid volgt deze basiscursus waar, naast zaken als techniek en veiligheid, ook materiaalkennis, keuze van kano of kajak aan bod komen.
          </p>
        </article>
      </div>
    </paper-card>

    <paper-card heading="Contributie">
      <div class="card-content">
        <table>
          <tr>
            <th>Omschrijving</th>
            <th>{{_period1}}</th>
            <th>{{_period2}}</th>
          </tr>
          <template is="dom-repeat" items="[[rowsCosts]]" as="row" filter="_isContributionCost">
            <tr>
              <td>{{row.gsx$description.$t}}</td>
              <td>{{row.gsx$period1.$t}}</td>
              <td>{{row.gsx$period2.$t}}</td>
            </tr>
          </template>
        </table>
      </div>
    </paper-card>

    <windhappers-notification type="info">
      Het lidmaatschap van het Watersportverbond is in deze contributie begrepen.
    </windhappers-notification>
    <windhappers-notification type="info">
      Indien meerdere personen uit één samenlevingsverband (wonende op hetzelfde adres) lid zijn, betalen het 4e en volgende lid geen contributie.
    </windhappers-notification>

    <paper-card heading="Stalling">
      <div class="card-content">
        <table>
          <tr>
            <th>Omschrijving</th>
            <th>{{_period1}}</th>
            <th>{{_period2}}</th>
          </tr>
          <template is="dom-repeat" items="[[rowsCosts]]" as="row" filter="_isStorageCost">
            <tr>
              <td>{{row.gsx$description.$t}}</td>
              <td>{{row.gsx$period1.$t}}</td>
              <td>{{row.gsx$period2.$t}}</td>
            </tr>
          </template>
        </table>
      </div>
    </paper-card>

    <paper-card heading="Overige">
      <div class="card-content">
        <table>
          <tr>
            <th>Omschrijving</th>
            <th>{{_period1}}</th>
            <th>{{_period2}}</th>
          </tr>
          <template is="dom-repeat" items="[[rowsCosts]]" as="row" filter="_isOtherCost">
            <tr>
              <td>{{row.gsx$description.$t}}</td>
              <td>{{row.gsx$period1.$t}}</td>
              <td>{{row.gsx$period2.$t}}</td>
            </tr>
          </template>
        </table>
      </div>
    </paper-card>

    <windhappers-notification type="warning">
      Een <em>opzegging</em> voor het volgende kalenderjaar, dient voor 31 December bekend te zijn bij de <a href="/contact">ledenadministrateur</a>.
    </windhappers-notification>

    <google-sheets  id="sheetVolunteers"
                    key="17WpTzAng1WyamrsJR40S2yECPQJGENhPaM4S0zeSdEY"
                    tab-id="1"
                    published
                    rows="{{rowsVolunteers}}"></google-sheets>

    <google-sheets  id="sheetCosts"
                    key="17WpTzAng1WyamrsJR40S2yECPQJGENhPaM4S0zeSdEY"
                    tab-id="2"
                    published
                    rows="{{rowsCosts}}"></google-sheets>

    <template is="dom-repeat" items="[[rowsVolunteers]]" as="row" filter="_isRelatedVolunteer">
      <windhappers-volunteer narrow$="[[narrow]]"
                             name="{{row.gsx$name.$t}}"
                             function="{{row.gsx$function.$t}}"
                             email="{{row.gsx$email.$t}}"
                             email-personal="{{row.gsx$emailpersonal.$t}}"
                             phone="{{row.gsx$phone.$t}}"> </windhappers-volunteer>
    </template>

  </template>
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'windhappers-page-costs',

        properties: {
          narrow: Boolean,
          _period1: String,
          _period2: String
        },

        observers: [
          '_computePeriods(rowsCosts)'
        ],

        _computePeriods: function() {
          var rows = this.$.sheetCosts.rows;
          rows.forEach(function(row) {
            if (row.gsx$type.$t == 'period') {
              this._period1 = row.gsx$period1.$t;
              this._period2 = row.gsx$period2.$t;
            }
          }.bind(this));
        },

        _isContributionCost: function(row) {
          return row.gsx$type.$t == 'contribution';
        },

        _isStorageCost: function(row) {
          return row.gsx$type.$t == 'storage';
        },

        _isOtherCost: function(row) {
          return row.gsx$type.$t == 'other';
        },

        _isRelatedVolunteer: function(row) {
          return row.gsx$function.$t == 'Ledenadministratie' || row.gsx$function.$t == 'Beheer boten en materieel' || row.gsx$function.$t == 'Introductiecursus' || row.gsx$function.$t == 'Penningmeester';
        }
      });
    })();
  </script>
</dom-module>
