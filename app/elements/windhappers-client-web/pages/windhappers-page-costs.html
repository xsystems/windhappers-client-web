<dom-module id="windhappers-page-costs">
  <template>
    <style>
      :host {
        @apply(--layout-horizontal);
        @apply(--layout-justified);
        @apply(--layout-wrap);
        padding-top: 1%;
        padding-left: 1%;
        padding-right: 1%;
      }

      windhappers-volunteer {
        margin-bottom: 1%;
      }

      windhappers-volunteer[narrow] {
        width: 100%;
      }

      windhappers-volunteer:not([narrow]) {
        width: 32.66%;
      }      

      paper-card.cost {
        width: 100%;
        margin-bottom: 1%;
      }

      table {
        border-collapse: collapse;
        width: 100%;
      }

      th {
        background-color: var(--primary-color);
        color: white;
      }

      th, td {
        text-align: left;
        padding: 1%;
      }

      tr:nth-child(even) {
        background-color: #f2f2f2
      }
    </style>

    <paper-card class="cost" heading="Contributie">
      <div class="card-content">
        <table>
          <tr>
            <th>Omschrijving</th>
            <th>{{_period1}}</th>
            <th>{{_period2}}</th>
          </tr>
          <template is="dom-repeat" items="[[rowsCosts]]" as="row" filter="_isContributionCost">
            <tr>
              <td>{{row.gsx$description.$t}}</td>
              <td>{{row.gsx$period1.$t}}</td>
              <td>{{row.gsx$period2.$t}}</td>
            </tr>
          </template>
        </table>
      </div>
    </paper-card>

    <paper-card class="cost" heading="Stalling">
      <div class="card-content">
        <table>
          <tr>
            <th>Omschrijving</th>
            <th>{{_period1}}</th>
            <th>{{_period2}}</th>
          </tr>
          <template is="dom-repeat" items="[[rowsCosts]]" as="row" filter="_isStorageCost">
            <tr>
              <td>{{row.gsx$description.$t}}</td>
              <td>{{row.gsx$period1.$t}}</td>
              <td>{{row.gsx$period2.$t}}</td>
            </tr>
          </template>
        </table>
      </div>
    </paper-card>

    <paper-card class="cost" heading="Overige">
      <div class="card-content">
        <table>
          <tr>
            <th>Omschrijving</th>
            <th>{{_period1}}</th>
            <th>{{_period2}}</th>
          </tr>
          <template is="dom-repeat" items="[[rowsCosts]]" as="row" filter="_isOtherCost">
            <tr>
              <td>{{row.gsx$description.$t}}</td>
              <td>{{row.gsx$period1.$t}}</td>
              <td>{{row.gsx$period2.$t}}</td>
            </tr>
          </template>
        </table>
      </div>
    </paper-card>  

    <google-sheets  id="sheetVolunteers" 
                    key="17WpTzAng1WyamrsJR40S2yECPQJGENhPaM4S0zeSdEY"
                    tab-id="1"
                    published 
                    rows="{{rowsVolunteers}}"></google-sheets>

    <google-sheets  id="sheetCosts" 
                    key="17WpTzAng1WyamrsJR40S2yECPQJGENhPaM4S0zeSdEY"
                    tab-id="2"
                    published 
                    rows="{{rowsCosts}}"></google-sheets>

    <template is="dom-repeat" items="[[rowsVolunteers]]" as="row" filter="_isRelatedVolunteer">
      <windhappers-volunteer narrow$="[[narrow]]"
                             name="{{row.gsx$name.$t}}"
                             function="{{row.gsx$function.$t}}"
                             email="{{row.gsx$email.$t}}"
                             email-personal="{{row.gsx$emailpersonal.$t}}"
                             phone="{{row.gsx$phone.$t}}"> </windhappers-volunteer>      
    </template>

  </template>
  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'windhappers-page-costs',

        properties: {
          narrow: Boolean,
          _period1: String,
          _period2: String
        },

        observers: [
          '_computePeriods(rowsCosts)'
        ],

        _computePeriods: function() {
          var rows = this.$.sheetCosts.rows;
          rows.forEach(function(row) {
            if (row.gsx$type.$t == 'period') {
              this._period1 = row.gsx$period1.$t;
              this._period2 = row.gsx$period2.$t;
            }
          }.bind(this));
        },

        _isContributionCost: function(row) {
          return row.gsx$type.$t == 'contribution';
        },

        _isStorageCost: function(row) {
          return row.gsx$type.$t == 'storage';
        },

        _isOtherCost: function(row) {
          return row.gsx$type.$t == 'other';
        },

        _isRelatedVolunteer: function(row) {
          return row.gsx$function.$t == 'Ledenadministratie' || row.gsx$function.$t == 'Beheer boten en materieel' || row.gsx$function.$t == 'Introductiecursus' || row.gsx$function.$t == 'Penningmeester';
        }
      });
    })();
  </script>
</dom-module>
